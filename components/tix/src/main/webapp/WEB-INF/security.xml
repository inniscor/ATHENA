<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
             http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
             http://www.springframework.org/schema/security
             http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">
  <http entry-point-ref="digestEntryPoint">
    <intercept-url pattern="/**" access="ROLE_USER" />
    <custom-filter position="BASIC_AUTH_FILTER" ref="digestFilter" />
  </http>

  <beans:bean id="dataSourceUsers" class="org.springframework.jdbc.datasource.DriverManagerDataSource" >
    <beans:property name="driverClassName">
      <beans:value>com.mysql.jdbc.Driver</beans:value>
    </beans:property>
    <beans:property name="url">
      <beans:value>jdbc:mysql://localhost/ATHENA-Security</beans:value>
    </beans:property>
    <beans:property name="username">
      <beans:value>root</beans:value>
    </beans:property>
    <beans:property name="password">
      <beans:value></beans:value>
    </beans:property>
  </beans:bean>

  <authentication-manager>
    <authentication-provider user-service-ref="jdbcUserService">
    </authentication-provider>
  </authentication-manager>

  <!-- This is unused -->
  <!--
  <user-service id="userService">
    <user name="completely" password="ignored" authorities="ROLE_USER" />
  </user-service>
  -->

<jdbc-user-service id="jdbcUserService" data-source-ref="dataSourceUsers"/>

  <beans:bean id="digestEntryPoint" class=
              "org.springframework.security.web.authentication.www.DigestAuthenticationEntryPoint">
    <beans:property name="realmName" value="ATHENA"/>
    <beans:property name="key" value="d1a5e26d0558c455d3860e26d0558c45585fad77d427"/>
    <beans:property name="nonceValiditySeconds" value="10"/>
  </beans:bean>

  <beans:bean id="digestFilter" class=
              "org.springframework.security.web.authentication.www.DigestAuthenticationFilter">
    <beans:property name="userDetailsService" ref="jdbcUserService"/>
    <beans:property name="authenticationEntryPoint" ref="digestEntryPoint"/>
  </beans:bean>
</beans:beans>
